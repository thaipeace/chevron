<div class="cl_medium_jungle_green-background px-3">
  <div class="header d-flex justify-content-between align-items-center py-3">
    <div><i class="fal fa-sync-alt refresh-icon clickable cursor-pointer" (click)="onRefesh()"></i></div>
    <div class="d-flex justify-content-center align-items-center">
      <search-box [searchControl]="searchControl" class="px-3"></search-box>
      <mat-paginator class="chevron-paginator ml-3" [length]="tableData?.data.length" [pageSize]="10"
        [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
      <input type="text" class="ml-3 date-picker" bsDaterangepicker placement="left"
				[(ngModel)]="selectedDate" (ngModelChange)="onTimeChange()" placeholder="Select date">
    </div>
  </div>

  <perfect-scrollbar class="table-material flex-grow-1">
    <table mat-table class="mat-elevation-z8 tql-table" [dataSource]="tableData" matSort>
      <ng-container matColumnDef="#">
        <th mat-header-cell *matHeaderCellDef>
          <ng-container *ngTemplateOutlet="ind"></ng-container>
          <ng-template #ind><span>#</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let i = index">
          <ng-container *ngTemplateOutlet="indV"></ng-container>
          <ng-template #indV>
            <div class="text-left">{{i + 1}}</div>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="queueDatetime">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="QueuedTime">
          <ng-container *ngTemplateOutlet="queueDatetime"></ng-container>
          <ng-template #queueDatetime><span>Queue Date Time</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngTemplateOutlet="queueDatetimeV"></ng-container>
          <ng-template #queueDatetimeV>
            <div class="text-left">
              {{row.QueuedTime && row.QueuedTime!=='NA' ? (row.QueuedTime | date:'yyyy-MM-dd (HH:mm)') : ''}}
            </div>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="activity">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="ActivityName">
          <ng-container *ngTemplateOutlet="activity"></ng-container>
          <ng-template #activity><span>Activity</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngTemplateOutlet="activityV"></ng-container>
          <ng-template #activityV>
            <div class="text-left">{{row.ActivityName}}</div>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="requestType">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="RequestType">
          <ng-container *ngTemplateOutlet="requestType"></ng-container>
          <ng-template #requestType><span>Request Type</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngTemplateOutlet="requestTypeV"></ng-container>
          <ng-template #requestTypeV>
            <div class="text-left">{{row.RequestType}}</div>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="requestBy">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="RequestedBy">
          <ng-container *ngTemplateOutlet="requestBy"></ng-container>
          <ng-template #requestBy><span>Request By</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngTemplateOutlet="requestByV"></ng-container>
          <ng-template #requestByV>
            <div class="text-left">{{row.RequestedBy}}</div>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="state">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="CurrentState">
          <ng-container *ngTemplateOutlet="state"></ng-container>
          <ng-template #state><span>State</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngTemplateOutlet="stateV"></ng-container>
          <ng-template #stateV>
            <div class="text-left">{{row.CurrentState}}</div>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="startDatetime">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="StartTime">
          <ng-container *ngTemplateOutlet="startDatetime"></ng-container>
          <ng-template #startDatetime><span>Start Date Time</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngTemplateOutlet="startDatetimeV"></ng-container>
          <ng-template #startDatetimeV>
            <div class="text-left">
              {{row.StartTime && row.StartTime!=='NA' ? (row.StartTime | date:'yyyy-MM-dd (HH:mm)') : ''}}
            </div>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="endDatetime">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="EndTime">
          <ng-container *ngTemplateOutlet="endDatetime"></ng-container>
          <ng-template #endDatetime><span>End Date Time</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngTemplateOutlet="endDatetimeV"></ng-container>
          <ng-template #endDatetimeV>
            <div class="text-left">
              {{row.EndTime && row.EndTime!=='NA' ? (row.EndTime | date:'yyyy-MM-dd (HH:mm)') : ''}}</div>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="progressStatus">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="ProgressStatus">
          <ng-container *ngTemplateOutlet="progressStatus"></ng-container>
          <ng-template #progressStatus><span>Progress Status %</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngTemplateOutlet="progressStatusV"></ng-container>
          <ng-template #progressStatusV>
            <div class="text-left">{{row.ProgressStatus}}</div>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="averageExcutionTimeSpan">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="AverageExecutionTime">
          <ng-container *ngTemplateOutlet="averageExcutionTimeSpan"></ng-container>
          <ng-template #averageExcutionTimeSpan><span>Average Excution Time Span</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngTemplateOutlet="averageExcutionTimeSpanV"></ng-container>
          <ng-template #averageExcutionTimeSpanV>
            <div class="text-left">{{row.AverageExecutionTime}}</div>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="completionStatus">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="CompletionStatus">
          <ng-container *ngTemplateOutlet="completionStatus"></ng-container>
          <ng-template #completionStatus><span>Completion Status</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngTemplateOutlet="completionStatusV"></ng-container>
          <ng-template #completionStatusV>
            <div class="text-left">{{row.CompletionStatus}}</div>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="remark">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="Remark">
          <ng-container *ngTemplateOutlet="remark"></ng-container>
          <ng-template #remark><span>Remark</span></ng-template>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngTemplateOutlet="remarkV"></ng-container>
          <ng-template #remarkV>
            <div class="text-left">{{row.Remark}}</div>
          </ng-template>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row (click)="onClickRow(row)" *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
    <!-- No search result -->
    <div *ngIf="tableData?.data.length > 0 && tableData?.filteredData.length == 0" class="no-result">
      No search result found
    </div>
    <!-- No data -->
    <div *ngIf="tableData?.data.length == 0" class="no-result">
      No data found
    </div>
  </perfect-scrollbar>
</div>