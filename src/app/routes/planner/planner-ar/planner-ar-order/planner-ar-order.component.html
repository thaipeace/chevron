<div class="p-3">
  <div class="mb-3 d-flex justify-content-between align-items-baseline pl-1">
    <div>
      <button *ngIf="userRoleName == 'Admin' || userRoleName == 'Planner'" mat-raised-button type="button"
        class="btn btn-blue mr-3" (click)="uploadSAPFile()"><i class="fal fa-file-import mr-2"></i>
        Import SAP File
      </button>
      <button mat-raised-button type="button" class="btn btn-blue mr-3" (click)="onExportOrders()">
        <i class="fal fa-cloud-download mr-2"></i> Export Orders
      </button>
      <button mat-raised-button type="button" class="btn btn-blue mr-3" (click)="onExportInventory()">
        <i class="fal fa-cloud-download mr-2"></i> Export Inventory
      </button>
      <button mat-raised-button type="button" (click)="onOpenApproveDialog()"
        [ngClass]="{'disabled-half': isARDataLoading || !orderNum}" class="btn btn-blue mr-3" *ngIf="isTomorrow">
        <i class="fal fa-check-circle mr-2"></i>Approve AR Data
      </button>
      <!--  <button mat-raised-button type="button" (click)="onOptimizeOrder()"
                          class="btn btn-blue mr-3">
                      <i class="fal fa-box-full mr-2"></i>Optimize Orders
                  </button>-->

    </div>

    <div class="top-bar d-flex justify-content-between align-items-center"
      [ngClass]="{'disabled-half': isARDataLoading}">

      <button *ngIf="!isTomorrow && (today.getDate() != selectedDate.getDate())" mat-raised-button type="button"
        class="btn btn-blue" (click)="selectedDate = today; onTimeChange()">
        Back to today
      </button>
      <div *ngIf="isTomorrow || (today.getDate() == selectedDate.getDate())" class="mr-3"
        [ngClass]="{'disabled-half': isDataChange}">
        <span class="title truck-action-bar-text truck-action-bar-text-spacing-left">Today</span>

        <button class="" mat-button [disableRipple]="true">
          <mat-slide-toggle [checked]="isTomorrow" (change)="toggle($event)" color="accent" [disableRipple]="true">
          </mat-slide-toggle>
        </button>

        <span class="title truck-action-bar-text truck-action-bar-text-spacing-left">Tomorrow</span>
      </div>
      <input [ngClass]="{'disabled-half': isDataChange}" type="text" class="ml-3 date-picker" bsDatepicker
        placement="left" [(ngModel)]="selectedDate" (ngModelChange)="onTimeChange($event)">
    </div>
  </div>
  <div class="mb-3 d-flex flex-row align-items-baseline pl-1" [ngClass]="{'disabled-half': isARDataLoading}">
    <button class="" mat-icon-button (click)="findAllARData()">
      <i class="fal fa-sync-alt"></i>
    </button>
    <div class="d-flex flex-row">
      <select-menu class="station-list mr-3" [items]="stations" [bindLabel]="'stationNameType'"
        (clearSearch)="clearSearch = $event" [multiple]="true" [bindValue]="'_data.sysId'"
        [placeHolder]="'Select Station'" [ngModel]="displayStations" matTooltip="Filter by station"
        (change)="onStationSelectionChange($event)">
      </select-menu>
      <search-box [searchControl]="searchControl"></search-box>
    </div>
    <button *ngIf="isDataChange" mat-raised-button type="button"
      class="btn-i btn-i-icon btn-cancel mat-raised-button text-white ml-3 mr-3" (click)="cancelUpdate()">
      <i class="fal fa-ban mr-3"></i> Cancel
    </button>
    <button *ngIf="isDataChange" mat-raised-button type="button"
      class="btn-i btn-i-icon btn-save mat-raised-button text-white mr-3" (click)="onUpdate()">
      <i class="fal fa-check ml-0 mr-1"></i> Update
    </button>
    <span class="flex-grow-1"></span>
    <select-menu class="station-list mr-3" [items]="fuelTypes" [multiple]="true" type="simpleArray"
      [ngModel]="fuelTypesSelected" [noMappingLabel]="true" [placeHolder]="'Select Fuel Types'"
      (change)="changeDisplayFuelTypes($event)">
    </select-menu>
    <select-menu class="station-list mr-3" [items]="tableHeadGroupData" [bindLabel]="'name'" [bindValue]="'value'"
      [multiple]="true" [ngModel]="tableHeadGroupSelect" [placeHolder]="'Select Column Groups'"
      (change)="changeDisplayHeadColumnGroup($event)">
    </select-menu>

    <mat-paginator class="chevron-paginator ml-3" [length]="100" [pageSize]="25" [pageSizeOptions]="[5, 10, 25, 100]">
    </mat-paginator>
  </div>
  <perfect-scrollbar class="position-relative ar-scroll height-ar">
    <div class="table-material ar-container pl-1" style="width: fit-content;">
      <div class="overlay"></div>
      <table mat-table [dataSource]="tableData" matSort matSortActive="stationName" matSortDirection="asc"
        class="mat-elevation-z8 ar-container-table bordered-table zoom-{{zoomLevel}}" id="ar-table">
        <!-- dayStock -->
        <ng-container matColumnDef="dayStock" sticky>
          <th style="background-color: #263653 !important;" [ngClass]="'br-15 station-col-half station-th'"
            mat-header-cell *matHeaderCellDef [style.text-align]="'center'" [attr.colspan]="1">
            <ng-container *ngTemplateOutlet="daystock"></ng-container>
            <ng-template #daystock>
              <div class="d-flex justify-content-between align-items-center">
                <mat-radio-group (change)="onScheduleChange($event)" aria-label="Select a day stock">
                  <mat-radio-button value="1" class="mr-4">+&nbsp; Plan</mat-radio-button>
                  <mat-radio-button [checked]="'true'" value="2" class="">-&nbsp; Plan
                  </mat-radio-button>
                </mat-radio-group>
              </div>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="customerDetails">
          <th style="background-color: #2496c9 !important;" [ngClass]="'station-col-half text-center'"
            mat-header-cell *matHeaderCellDef colspan="1">
            <ng-container *ngTemplateOutlet="customerDetails"></ng-container>
            <ng-template #customerDetails>
              <span>Cust. Details</span>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="customerDetailsEmpty">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
        </ng-container>

        <!-- inventoryVarianceEntry -->
        <ng-container matColumnDef="inventoryVarianceEntry">
          <th style="background-color: #2496c9 !important;" [ngClass]="'text-center'" mat-header-cell
            *matHeaderCellDef [attr.colspan]="tableGroupCol + 1">
            <ng-container *ngTemplateOutlet="inventoryVarianceEntry"></ng-container>
            <ng-template #inventoryVarianceEntry>
              <span>Inventory Manual(M) Entry</span>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="inventoryVarianceEntryEmpty">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
        </ng-container>

        <!-- inventoryVarianceComputeManual -->

        <ng-container matColumnDef="inventoryVarianceComputeManual">
          <th style="background-color: #2496c9 !important;" [ngClass]="'text-center'" mat-header-cell
            *matHeaderCellDef [attr.colspan]="tableGroupCol*2">
            <ng-container *ngTemplateOutlet="inventoryVarianceComputeManual"></ng-container>
            <ng-template #inventoryVarianceComputeManual>
              <span>Inventory Variance (Compute & Manual)</span>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="inventoryVarianceComputeManualEmpty">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
        </ng-container>

        <!-- uGTDayStock -->

        <ng-container matColumnDef="uGTDayStock">
          <th style="background-color: #2496c9 !important;" [ngClass]="'text-center'" mat-header-cell
            *matHeaderCellDef [attr.colspan]="tableGroupCol">
            <ng-container *ngTemplateOutlet="uGTDayStock"></ng-container>
            <ng-template #uGTDayStock>
              <span>UGT Day Stock</span>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="uGTDayStockEmpty">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
        </ng-container>

        <!-- underGroundTankUllage -->

        <ng-container matColumnDef="underGroundTankUllage">
          <th style="background-color: #2496c9 !important;" [ngClass]="'text-center'" mat-header-cell
            *matHeaderCellDef [attr.colspan]="tableGroupCol">
            <ng-container *ngTemplateOutlet="underGroundTankUllage"></ng-container>
            <ng-template #underGroundTankUllage>
              <span>Under Ground Tank(UGT) Ullage</span>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="underGroundTankUllageEmpty">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
        </ng-container>

        <!-- deliverySchedulePlanning -->

        <ng-container matColumnDef="deliverySchedulePlanning">
          <th style="background-color: #2496c9 !important;" [ngClass]="'text-center'" mat-header-cell
            *matHeaderCellDef [attr.colspan]="tableGroupCol + 4">
            <ng-container *ngTemplateOutlet="deliverySchedulePlanning"></ng-container>
            <ng-template #deliverySchedulePlanning>
              <div class="d-flex flex-row justify-content-center align-items-center">
                Delivery Schedule Planning
              </div>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="deliverySchedulePlanningEmpty">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
        </ng-container>

        <!-- quotaAllocations -->

        <ng-container matColumnDef="quotaAllocations">
          <th style="background-color: #2496c9 !important;" [ngClass]="'text-center'" mat-header-cell *matHeaderCellDef
            [attr.colspan]="2">
            <ng-container *ngTemplateOutlet="quotaAllocations"></ng-container>
            <ng-template #quotaAllocations>
              <span>Quota Allocations</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- Second header layer -->

        <!-- subDayStock -->
        <ng-container matColumnDef="subDayStock" sticky>
          <th style="background-color: #263653 !important;" [ngClass]="'br-15 station-col-name pt-0 pb-0'"
            mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="zommin"></ng-container>
            <ng-template #zommin>
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <label for="search-minus"><i id="search-minus" (click)="zoomOut()"
                      class="fal fa-search-minus text-white cursor"></i>
                    <small (click)="zoomOut()" class="ml-1 cursor">A
                    </small>
                  </label>
                  &nbsp;
                  <label for="search-plus"><i id="search-plus" (click)="zoomIn()"
                      class="fal fa-search-plus text-white cursor"></i><span (click)="zoomIn()"
                      class="ml-1 zoom-in-font cursor">A</span></label>
                </div>
              </div>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="subCustomerDetails">
          <th style="background-color: #263653 !important;" [ngClass]="'station-col-half pt-0 pb-0'"
            mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="category"></ng-container>
            <ng-template #category>
              <span>Category</span>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="subCustomerDetailsEmpty">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
        </ng-container>

        <!-- Inventory Manual(M) Entry section -->
        <!-- IMEEuro4-97 -->
        <ng-container matColumnDef="IMEEuro497">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title euro4-97 br-1 bb-1'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="IMEEuro497"></ng-container>
            <ng-template #IMEEuro497>
              <span>Euro4-97</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEPremium-95 -->
        <ng-container matColumnDef="IMEPremium95">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title premium-95 br-1 bb-1'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="IMEPremium95"></ng-container>
            <ng-template #IMEPremium95>
              <span>Premium-95</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEB10-Diesel -->
        <ng-container matColumnDef="IMEB10Diesel">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center  product-code-title diesel-c br-1 bb-1'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="IMEB10Diesel"></ng-container>
            <ng-template #IMEB10Diesel>
              <span>B10-Diesel</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEEuro5-B7 -->
        <ng-container matColumnDef="IMEEuro5B7">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title euro5-b7 br-1 bb-1'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="IMEEuro5B7"></ng-container>
            <ng-template #IMEEuro5B7>
              <span>Euro5-B7</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMERemarks -->
        <ng-container matColumnDef="IMERemarks">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="IMERemarks"></ng-container>
            <ng-template #IMERemarks>
              <span>Remarks</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- Inventory Variance (Compute & Manual) section-->


        <!-- IMEEuro5-B7 -->
        <ng-container matColumnDef="IVCMEuro497">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title euro4-97 br-1 bb-1'" [attr.colspan]="2" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="IVCMEuro497"></ng-container>
            <ng-template #IVCMEuro497>
              <span>Euro4-97</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEPremium-95 -->
        <ng-container matColumnDef="IVCMPremium95">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title premium-95 br-1 bb-1'" [attr.colspan]="2" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="IVCMPremium95"></ng-container>
            <ng-template #IVCMPremium95>
              <span>Premium-95</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEB10-Diesel -->
        <ng-container matColumnDef="IVCMB10Diesel">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title diesel-c br-1 bb-1'" [attr.colspan]="2" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="IVCMB10Diesel"></ng-container>
            <ng-template #IVCMB10Diesel>
              <span>B10-Diesel</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEEuro5-B7 -->
        <ng-container matColumnDef="IVCMEuro5B7">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center product-code-title euro5-b7'"
            [attr.colspan]="2" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="IVCMEuro5B7"></ng-container>
            <ng-template #IVCMEuro5B7>
              <span>Euro5-B7</span>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="IVCMEmpty">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
        </ng-container>

        <!-- uGTDayStock section -->


        <ng-container matColumnDef="UGTDSEuro497">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title euro4-97 br-1 bb-1'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="UGTDSEuro497"></ng-container>
            <ng-template #UGTDSEuro497>
              <span>Euro4-97</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEPremium-95 -->
        <ng-container matColumnDef="UGTDSPremium95">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title premium-95 br-1 bb-1'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="UGTDSPremium95"></ng-container>
            <ng-template #UGTDSPremium95>
              <span>Premium-95</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEB10-Diesel -->
        <ng-container matColumnDef="UGTDSB10Diesel">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center  product-code-title diesel-c br-1 bb-1'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="UGTDSB10Diesel"></ng-container>
            <ng-template #UGTDSB10Diesel>
              <span>B10-Diesel</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEEuro5-B7 -->
        <ng-container matColumnDef="UGTDSEuro5B7">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center product-code-title euro5-b7'"
            mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="UGTDSEuro5B7"></ng-container>
            <ng-template #UGTDSEuro5B7>
              <span>Euro5-B7</span>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="UGTDSEmpty">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
        </ng-container>
        <!-- Under Ground Tank(UGT) Ullage section -->

        <ng-container matColumnDef="UGTUSEuro497">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title euro4-97 br-1 bb-1'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="UGTUSEuro497"></ng-container>
            <ng-template #UGTUSEuro497>
              <span>Euro4-97</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEPremium-95 -->
        <ng-container matColumnDef="UGTUSPremium95">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title premium-95 br-1 bb-1'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="UGTUSPremium95"></ng-container>
            <ng-template #UGTUSPremium95>
              <span>Premium-95</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEB10-Diesel -->
        <ng-container matColumnDef="UGTUSB10Diesel">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center  product-code-title diesel-c br-1 bb-1'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="UGTUSB10Diesel"></ng-container>
            <ng-template #UGTUSB10Diesel>
              <span>B10-Diesel</span>
            </ng-template>
        </ng-container>

        <!-- IMEEuro5-B7 -->
        <ng-container matColumnDef="UGTUSEuro5B7">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title euro5-b7 br-1 bb-1'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="UGTUSEuro5B7"></ng-container>
            <ng-template #UGTUSEuro5B7>
              <span>Euro5-B7</span>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="UGTUSEmpty">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
        </ng-container>

        <!-- Delivery Schedule Planning section -->
        <ng-container matColumnDef="DSPOrderNumber">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center planner-schedule-w br-1 bb-1'"
            mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="DSPOrderNumber"></ng-container>
            <ng-template #DSPOrderNumber>
              <span>Order Index</span>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="DSPEuro497">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center product-code-title euro4-97 planner-schedule-w br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="DSPEuro497"></ng-container>
            <ng-template #DSPEuro497>
              <span>Euro4-97</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEPremium-95 -->
        <ng-container matColumnDef="DSPPremium95">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center  product-code-title premium-95 planner-schedule-w br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="DSPPremium95"></ng-container>
            <ng-template #DSPPremium95>
              <span>Premium-95</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEB10-Diesel -->
        <ng-container matColumnDef="DSPB10Diesel">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center  product-code-title diesel-c planner-schedule-w br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="DSPB10Diesel"></ng-container>
            <ng-template #DSPB10Diesel>
              <span>B10-Diesel</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- IMEEuro5-B7 -->
        <ng-container matColumnDef="DSPEuro5B7">
          <th style="background-color: #263653 !important;"
            [ngClass]="'text-center  product-code-title Euro5-B7 planner-schedule-w br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="DSPEuro5B7"></ng-container>
            <ng-template #DSPEuro5B7>
              <span>Euro5-B7</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- TotalQuantity -->
        <ng-container matColumnDef="TotalQuantity">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center planner-schedule-w br-1 bb-1'"
            mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="TotalQuantity"></ng-container>
            <ng-template #TotalQuantity>
              <span>Total Quantity</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- ETA -->
        <ng-container matColumnDef="ETA">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center planner-schedule-w br-1 bb-1'"
            mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="ETA"></ng-container>
            <ng-template #ETA>
              <span>ETA</span>
            </ng-template>
          </th>
        </ng-container>

        <!-- DSPRemarks -->
        <ng-container matColumnDef="DSPRemarks">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center planner-schedule-w'"
            mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="DSPRemarks"></ng-container>
            <ng-template #DSPRemarks>
              <span>Remarks</span>
            </ng-template>
          </th>
        </ng-container>

        <ng-container matColumnDef="deliverySchedulePlanningEmptySub">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
        </ng-container>

        <!-- QAB10Diesel -->
        <ng-container matColumnDef="QAB10Diesel">
          <th style="background-color: #263653 !important;" [attr.colspan]="2"
            [ngClass]="'text-center product-code-title diesel-c'" mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="QAB10Diesel"></ng-container>
            <ng-template #QAB10Diesel>
              <span>B10-Diesel</span>
            </ng-template>
          </th>
        </ng-container>


        <!-- Third Header Layer -->


        <!-- Station Section -->

        <ng-container matColumnDef="stationName" sticky>
          <th style="background-color: #2496c9 !important;" [ngClass]="'br-15 station-col-name station-th bb-1'"
            mat-header-cell mat-sort-header="stationName" *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="stationName"></ng-container>
            <ng-template #stationName>
              <div class="d-flex justify-content-between w-100">
                <div class="d-flex flex-row">
                  <div class="index-station-col text-left">
                    <span>#</span>
                  </div>
                  <span class="station-name">Station name</span>
                </div>
              </div>
            </ng-template>
          </th>
          <td mat-cell *matCellDef="let element; let i = index" [ngClass]="'br-15 station-col-name bb-1'">
            <ng-container *ngTemplateOutlet="stationNameValue"></ng-container>
            <ng-template #stationNameValue>
              <div class="d-flex justify-content-between">
                <div class="d-flex w-100">
                  <div class="index-station-col">
                    <span>{{element.rowNo + 1}}</span>
                  </div>
                  <div class="station-name">{{element.stationName}}</div>
                </div>
              </div>
              <div class="bordered"></div>
            </ng-template>
          </td>
        </ng-container>

        <ng-container matColumnDef="catEmpty">
          <th style="background-color: #263653 !important;" [ngClass]="'station-col-half station-th bb-1'"
            mat-header-cell *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="cat"></ng-container>
            <ng-template #cat>
              <span></span>
            </ng-template>
          </th>
          <td mat-cell *matCellDef="let element; let i = index" [ngClass]="'station-col-half bb-1'">
            <ng-container *ngTemplateOutlet="catValue"></ng-container>
            <ng-template #catValue>
              <div class="d-flex justify-content-center">
                <span class="text-green text-center">{{element.stationType}}</span>
              </div>
            </ng-template>
          </td>
        </ng-container>

        <ng-container matColumnDef="catEmptySub">
          <th mat-header-cell *matHeaderCellDef class="empty-cell br-15"></th>
          <td mat-header-cell *matCellDef="let element" class="empty-cell br-15"></td>
        </ng-container>
        <!-- inventoryManualEntry section  -->

        <!-- subIMEEuro497 -->
        <ng-container matColumnDef="subIMEEuro497">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="subIMEEuro497"></ng-container>
            <ng-template #subIMEEuro497>
              <span></span>
            </ng-template>
          </th>

          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.actualInventories['Euro4-97']?.TotalQuantity}}</span>
          </td>
        </ng-container>

        <!-- subIMEPremium95 -->
        <ng-container matColumnDef="subIMEPremium95">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="subIMEPremium95"></ng-container>
            <ng-template #subIMEPremium95>
              <span></span>
            </ng-template>
          </th>

          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.actualInventories['Premium-95']?.TotalQuantity}}</span>
          </td>
        </ng-container>

        <!--subIMEB10Diesel -->
        <ng-container matColumnDef="subIMEB10Diesel">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="subIMEB10Diesel"></ng-container>
            <ng-template #subIMEB10Diesel>
              <span></span>
            </ng-template>
          </th>

          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.actualInventories['B10-Diesel']?.TotalQuantity}}</span>
          </td>
        </ng-container>

        <!-- subIMEEuro5B7 -->
        <ng-container matColumnDef="subIMEEuro5B7">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="subIMEEuro5B7"></ng-container>
            <ng-template #subIMEEuro5B7>
              <span></span>
            </ng-template>
          </th>

          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.actualInventories['Euro5-B7']?.TotalQuantity}}</span>
          </td>
        </ng-container>

        <!-- subIMERemarks -->
        <ng-container matColumnDef="subIMERemarks">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="subIMERemarks"></ng-container>
            <ng-template #subIMERemarks>
              <span></span>
            </ng-template>
          </th>

          <td mat-cell *matCellDef="let element" [ngClass]="'bb-1'"></td>
        </ng-container>

        <ng-container matColumnDef="inventoryVarianceEntrySubEmpty">
          <th class="empty-cell br-15" mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let element" [ngClass]="'empty-cell br-15'"></td>
        </ng-container>

        <!-- Inventory Variance (Compute & Manual) section  -->

        <ng-container matColumnDef="stockEuro497">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="stockEuro497"></ng-container>
            <ng-template #stockEuro497>
              <span>Stock B/F</span>
            </ng-template>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.varianceInventories['Euro4-97']?.TotalQuantity}}</span>
          </td>
        </ng-container>

        <!-- varEuro497 -->
        <ng-container matColumnDef="varEuro497">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="varEuro497"></ng-container>
            <ng-template #varEuro497>
              <span>Var %</span>
            </ng-template>
          </th>
          <td mat-cell *matCellDef="let element" class="br-1 bb-1"
            [ngClass]="{'text-right': true, 'no-stk text-white': element && element.varianceInventories['Euro4-97'] && !element.varianceInventories['Euro4-97'].Variance, 'text-white more-variance':element && element?.varianceInventories['Euro4-97'] && element?.varianceInventories['Euro4-97']?.Variance  && element.varianceInventories['Euro4-97']?.Variance | varianceChecking:[varianceNotificationLimit]}">
            <ng-container *ngTemplateOutlet="varEuro497Value"></ng-container>
            <ng-template #varEuro497Value>
              <span class="text-white"
                *ngIf="element && element.varianceInventories['Euro4-97'] && !element.varianceInventories['Euro4-97'].Variance">
                No Stk
              </span>
              <span
                *ngIf="element && element.varianceInventories['Euro4-97'] && element.varianceInventories['Euro4-97'].Variance">
                {{element.varianceInventories['Euro4-97']?.Variance}}%
              </span>
            </ng-template>
          </td>
        </ng-container>

        <!-- stockPremium95 -->
        <ng-container matColumnDef="stockPremium95">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="stockPremium95"></ng-container>
            <ng-template #stockPremium95>
              <span>Stock B/F</span>
            </ng-template>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.varianceInventories['Premium-95']?.TotalQuantity}}</span>
          </td>
        </ng-container>

        <!-- varPremium95 -->
        <ng-container matColumnDef="varPremium95">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="varPremium95"></ng-container>
            <ng-template #varPremium95>
              <span>Var %</span>
            </ng-template>
          </th>
          <td mat-cell *matCellDef="let element" class="br-1 bb-1"
            [ngClass]="{'text-right': true, 'no-stk text-white': element && element.varianceInventories['Premium-95'] && !element.varianceInventories['Premium-95'].Variance, 'text-white more-variance':element && element?.varianceInventories['Premium-95'] && element?.varianceInventories['Premium-95']?.Variance && element.varianceInventories['Premium-95']?.Variance | varianceChecking:[varianceNotificationLimit]  }">
            <ng-container *ngTemplateOutlet="varEuro497Value"></ng-container>
            <ng-template #varEuro497Value>
              <span class="text-white"
                *ngIf="element && element.varianceInventories['Premium-95'] && !element.varianceInventories['Premium-95'].Variance">
                No Stk
              </span>
              <span
                *ngIf="element && element.varianceInventories['Premium-95'] && element.varianceInventories['Premium-95'].Variance">
                {{element.varianceInventories['Premium-95']?.Variance}}%
              </span>
            </ng-template>
          </td>
        </ng-container>

        <!-- stockB10Diesel -->
        <ng-container matColumnDef="stockB10Diesel">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="stockB10Diesel"></ng-container>
            <ng-template #stockB10Diesel>
              <span>Stock B/F</span>
            </ng-template>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.varianceInventories['B10-Diesel']?.TotalQuantity}}</span>
          </td>
        </ng-container>

        <!-- varB10Diesel -->
        <ng-container matColumnDef="varB10Diesel">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="varB10Diesel"></ng-container>
            <ng-template #varB10Diesel>
              <span>Var %</span>
            </ng-template>
          </th>
          <td mat-cell *matCellDef="let element" class="br-1 bb-1"
            [ngClass]="{'text-right': true, 'no-stk text-white': element && element.varianceInventories['B10-Diesel'] && !element.varianceInventories['B10-Diesel'].Variance, 'text-white more-variance':element && element?.varianceInventories['B10-Diesel'] && element?.varianceInventories['B10-Diesel']?.Variance && element.varianceInventories['B10-Diesel']?.Variance | varianceChecking:[varianceNotificationLimit] }">
            <ng-container *ngTemplateOutlet="varEuro497Value"></ng-container>
            <ng-template #varEuro497Value>
              <span class="text-white"
                *ngIf="element && element.varianceInventories['B10-Diesel'] && !element.varianceInventories['B10-Diesel'].Variance">
                No Stk
              </span>
              <span
                *ngIf="element && element.varianceInventories['B10-Diesel'] && element.varianceInventories['B10-Diesel'].Variance">
                {{element.varianceInventories['B10-Diesel']?.Variance}}%
              </span>
            </ng-template>
          </td>
        </ng-container>

        <!-- stockEuro5B7 -->
        <ng-container matColumnDef="stockEuro5B7">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="stockEuro5B7"></ng-container>
            <ng-template #stockEuro5B7>
              <span>Stock B/F</span>
            </ng-template>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.varianceInventories['Euro5-B7']?.TotalQuantity}}</span>
          </td>
        </ng-container>

        <!-- varEuro5B7 -->
        <ng-container matColumnDef="varEuro5B7">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="varEuro5B7"></ng-container>
            <ng-template #varEuro5B7>
              <span>Var %</span>
            </ng-template>
          </th>
          <td mat-cell *matCellDef="let element" class="br-1 bb-1"
            [ngClass]="{'text-right': true, 'no-stk text-white': element && element.varianceInventories['Euro5-B7'] && !element.varianceInventories['Euro5-B7'].Variance, 'text-white more-variance':element && element?.varianceInventories['Euro5-B7'] && element.varianceInventories['Euro5-B7']?.Variance | varianceChecking:[varianceNotificationLimit]}">
            <ng-container *ngTemplateOutlet="varEuro497Value"></ng-container>
            <ng-template #varEuro497Value>
              <span class="text-white"
                *ngIf="element && element.varianceInventories['Euro5-B7'] && !element.varianceInventories['Euro5-B7'].Variance">
                No Stk
              </span>
              <span
                *ngIf="element && element.varianceInventories['Euro5-B7'] && element.varianceInventories['Euro5-B7'].Variance">
                {{element.varianceInventories['Euro5-B7']?.Variance}}%
              </span>
            </ng-template>
          </td>
        </ng-container>

        <ng-container matColumnDef="IVCMEmptySub">
          <th mat-header-cell *matHeaderCellDef class="empty-cell br-15"></th>
          <td mat-header-cell *matCellDef="let element" class="empty-cell br-15">
          </td>
        </ng-container>
        <!-- ugtStock Section -->

        <!-- blockUGTDSEuro497 -->
        <ng-container matColumnDef="blockUGTDSEuro497">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" class="br-1 bb-1"
            [ngClass]="{'text-right':true, 'dl-under-22 text-white': isDayLast == '2' && element.dayStocks['Euro4-97'] && element.dayStocks['Euro4-97'].DayLast < 2.2, 'under-22 text-white': isDayLast == '1' && element.dayStocks['Euro4-97'] && element.dayStocks['Euro4-97'].DayLastWithOrder < 2.2}">
            <ng-container *ngTemplateOutlet="blockUGTDSEuro497"></ng-container>
            <ng-template #blockUGTDSEuro497>
              <div *ngIf="isDayLast == 2" class="w-100 h-100 d-flex align-items-center">
                {{element.dayStocks['Euro4-97']?.DayLast}}
              </div>
              <div *ngIf="isDayLast == 1" class="w-100 h-100 d-flex align-items-center">
                {{element.dayStocks['Euro4-97']?.DayLastWithOrder}}
              </div>
            </ng-template>
          </td>
        </ng-container>

        <!-- blockUGTDSPremium95 -->
        <ng-container matColumnDef="blockUGTDSPremium95">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" class="br-1 bb-1"
            [ngClass]="{'text-right':true, 'dl-under-22 text-white': isDayLast == '2' && element.dayStocks['Premium-95'] && element.dayStocks['Premium-95'].DayLast < 2.2, 'under-22 text-white': isDayLast == '1' && element.dayStocks['Premium-95'] && element.dayStocks['Premium-95'].DayLastWithOrder < 2.2}">
            <ng-container *ngTemplateOutlet="blockUGTDSEuro497"></ng-container>
            <ng-template #blockUGTDSEuro497>
              <div *ngIf="isDayLast == 2" class="w-100 h-100 d-flex align-items-center">
                {{element.dayStocks['Premium-95']?.DayLast}}
              </div>
              <div *ngIf="isDayLast == 1" class="w-100 h-100 d-flex align-items-center">
                {{element.dayStocks['Premium-95']?.DayLastWithOrder}}
              </div>
            </ng-template>
          </td>
        </ng-container>

        <!-- blockUGTDSB10Diesel -->
        <ng-container matColumnDef="blockUGTDSB10Diesel">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" class="br-1 bb-1"
            [ngClass]="{'text-right':true, 'dl-under-22': isDayLast == 2 && element.dayStocks['B10-Diesel'] && element.dayStocks['B10-Diesel'].DayLast < 2.2, 'under-22': isDayLast == 1 && element.dayStocks['B10-Diesel'] && element.dayStocks['B10-Diesel'].DayLastWithOrder < 2.2}">
            <ng-container *ngTemplateOutlet="blockUGTDSEuro497"></ng-container>
            <ng-template #blockUGTDSEuro497>
              <div *ngIf="isDayLast == 2" class="w-100 h-100 d-flex align-items-center">
                {{element.dayStocks['B10-Diesel']?.DayLast}}
              </div>
              <div *ngIf="isDayLast == 1" class="w-100 h-100 d-flex align-items-center">
                {{element.dayStocks['B10-Diesel']?.DayLastWithOrder}}
              </div>
            </ng-template>
          </td>
        </ng-container>

        <!-- blockUGTDSEuro5B7 -->
        <ng-container matColumnDef="blockUGTDSEuro5B7">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" class="bb-1"
            [ngClass]="{'text-right':true, 'dl-under-22 text-white': isDayLast == 2 && element.dayStocks['Euro5-B7'] && element.dayStocks['Euro5-B7'].DayLast < 2.2, 'under-22 text-white': isDayLast == 1 && element.dayStocks['Euro5-B7'] && element.dayStocks['Euro5-B7'].DayLastWithOrder < 2.2}">
            <ng-container *ngTemplateOutlet="blockUGTDSEuro497"></ng-container>
            <ng-template #blockUGTDSEuro497>
              <div *ngIf="isDayLast == 2" class="w-100 h-100 d-flex align-items-center">
                {{element.dayStocks['Euro5-B7']?.DayLast}}
              </div>
              <div *ngIf="isDayLast == 1" class="w-100 h-100 d-flex align-items-center">
                {{element.dayStocks['Euro5-B7']?.DayLastWithOrder}}
              </div>
            </ng-template>
          </td>
        </ng-container>

        <ng-container matColumnDef="UGTDSEmptySub">
          <th mat-header-cell *matHeaderCellDef class="empty-cell br-15"></th>
          <td mat-header-cell *matCellDef="let element" class="empty-cell br-15">
          </td>
        </ng-container>
        <!-- Under Ground Tank(UGT) Ullage section  -->

        <!-- blockUGTUSEuro497 -->
        <ng-container matColumnDef="blockUGTUSEuro497">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.ullageData['Euro4-97']?.TotalQuantity || element.ullageData['Euro4-97']?.TotalUllage}}</span>
          </td>
        </ng-container>

        <!-- blockUGTUSPremium95 -->
        <ng-container matColumnDef="blockUGTUSPremium95">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.ullageData['Premium-95']?.TotalQuantity || element.ullageData['Premium-95']?.TotalUllage}}</span>
          </td>
        </ng-container>

        <!-- blockUGTUSB10Diesel -->
        <ng-container matColumnDef="blockUGTUSB10Diesel">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.ullageData['B10-Diesel']?.TotalQuantity || element.ullageData['B10-Diesel']?.TotalUllage}}</span>
          </td>
        </ng-container>

        <!-- blockUGTUSEuro5B7 -->
        <ng-container matColumnDef="blockUGTUSEuro5B7">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'text-right br-1 bb-1'">
            <span>{{element.ullageData['Euro5-B7']?.TotalQuantity || element.ullageData['Euro5-B7']?.TotalUllage}}</span>
          </td>
        </ng-container>

        <ng-container matColumnDef="UGTUSEmptySub">
          <th mat-header-cell *matHeaderCellDef class="empty-cell br-15"></th>
          <td mat-header-cell *matCellDef="let element" class="empty-cell br-15">
          </td>
        </ng-container>
        <!-- Delivery Schedule Planning section  -->

        <ng-container matColumnDef="blockDSPOrderNumber">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'br-1 bb-1'">
            <span>{{element.orderNumber}}</span>
          </td>
        </ng-container>

        <!-- blockDSPEuro497 -->
        <ng-container matColumnDef="blockDSPEuro497">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" class="br-1 bb-1">
            <span
              *ngIf="element.orderDetails['ron97'] && (selectedDate < today || (element.orderStatus | checkInArray: status))">
              {{element.orderDetails.products.get('Euro4-97').value}}
            </span>
            <div
              *ngIf="element.orderDetails['ron97'] && selectedDate >= today && element.orderDetails.estimatedTime && !(element.orderStatus | checkInArray: status)"
              class=" w-100 h-100 d-flex justify-content-center align-element.orderDetailss-center "
              (focusin)="onEdit(element.index, element.orderDetails, 'Euro4-97'); hasSwitched = true; dayStockLast=''">
              <input type="number" min="0" title="{{element.orderDetails.products.get('Euro4-97').value}}"
                (focusout)="focusOut(element.orderDetails, 'Euro4-97')" [readonly]="!element.orderDetails.estimatedTime"
                class="ar-planning-schedule-w-auto text-field size-14 ar-planning editable"
                [ngClass]="{'edited': element.orderDetails.products.get('Euro4-97').value !== element.orderDetails.fixedProducts['Euro4-97']}"
                [formControl]="element.orderDetails.products.get('Euro4-97')" [matAutocomplete]="auto">
            </div>
            <div *ngIf="element.orderDetails['ron97'] && element.orderDetails.error" class="error">
              <small>{{element.orderDetails.error}}</small>
            </div>
          </td>
        </ng-container>

        <!-- blockDSPPremium95 -->
        <ng-container matColumnDef="blockDSPPremium95">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" class="br-1 bb-1">
            <span
              *ngIf="element.orderDetails['ron95'] && (selectedDate < today || (element.orderStatus | checkInArray: status))">
              {{element.orderDetails.products.get('Premium-95').value}}
            </span>
            <div
              *ngIf="element.orderDetails['ron95'] && selectedDate >= today && element.orderDetails.estimatedTime && !(element.orderStatus | checkInArray: status)"
              class=" w-100 h-100 d-flex justify-content-center align-element.orderDetailss-center "
              (focusin)="onEdit(element.index, element.orderDetails, 'Premium-95'); hasSwitched = true; dayStockLast=''">
              <input type="number" min="0" (focusout)="focusOut(element.orderDetails, 'Premium-95')"
                title="{{element.orderDetails.products.get('Premium-95').value}}"
                class="ar-planning-schedule-w-auto text-field size-14 ar-planning editable"
                [ngClass]="{'edited': element.orderDetails.products.get('Premium-95').value !== element.orderDetails.fixedProducts['Premium-95']}"
                [formControl]="element.orderDetails.products.get('Premium-95')" [matAutocomplete]="auto">
            </div>
            <div *ngIf="element.orderDetails['ron95'] && element.orderDetails.error" class="error">
              <small>{{element.orderDetails.error}}</small>
            </div>
          </td>
        </ng-container>

        <!-- blockDSPB10Diesel -->
        <ng-container matColumnDef="blockDSPB10Diesel">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" class="br-1 bb-1">
            <span
              *ngIf="element.orderDetails['ron10'] && (selectedDate < today || (element.orderStatus | checkInArray: status))">
              {{element.orderDetails.products.get('B10-Diesel').value}}
            </span>
            <div
              *ngIf="element.orderDetails['ron10'] && selectedDate >= today && element.orderDetails.estimatedTime && !(element.orderStatus | checkInArray: status)"
              class=" w-100 h-100 d-flex justify-content-center align-element.orderDetailss-center "
              (focusin)="onEdit(element.index, element.orderDetails, 'B10-Diesel'); hasSwitched = true; dayStockLast=''">
              <input type="number" min="0" (focusout)="focusOut(element.orderDetails, 'B10-Diesel')"
                title="{{element.orderDetails.products.get('B10-Diesel').value}}"
                class="ar-planning-schedule-w-auto text-field size-14 ar-planning editable"
                [ngClass]="{'edited': element.orderDetails.products.get('B10-Diesel').value !== element.orderDetails.fixedProducts['B10-Diesel']}"
                [formControl]="element.orderDetails.products.get('B10-Diesel')" [matAutocomplete]="auto">
            </div>
            <div *ngIf="element.orderDetails['ron10'] && element.orderDetails.error" class="error">
              <small>{{element.orderDetails.error}}</small>
            </div>
          </td>
        </ng-container>

        <!-- blockDSPEuro5B7 -->
        <ng-container matColumnDef="blockDSPEuro5B7">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" class="br-1 bb-1">
            <span
              *ngIf="element.orderDetails['ronB7'] && (selectedDate < today || (element.orderStatus | checkInArray: status))">
              {{element.orderDetails.products.get('Euro5-B7').value}}
            </span>
            <div
              *ngIf="element.orderDetails['ronB7'] && selectedDate >= today  && element.orderDetails.estimatedTime && !(element.orderStatus | checkInArray: status)"
              class=" w-100 h-100 d-flex justify-content-center align-element.orderDetailss-center "
              (focusin)="onEdit(element.index, element.orderDetails, 'Euro5-B7'); hasSwitched = true; dayStockLast=''">
              <input type="number" min="0" (focusout)="focusOut(element.orderDetails, 'Euro5-B7')"
                title="{{element.orderDetails.products.get('Euro5-B7').value}}"
                class="ar-planning-schedule-w-auto text-field size-14 ar-planning editable"
                [ngClass]="{'edited': element.orderDetails.products.get('Euro5-B7').value !== element.orderDetails.fixedProducts['Euro5-B7']}"
                [formControl]="element.orderDetails.products.get('Euro5-B7')" [matAutocomplete]="auto">
            </div>
            <div *ngIf="element.orderDetails['ronB7'] && element.orderDetails.error" class="error">
              <small>{{element.orderDetails.error}}</small>
            </div>
          </td>
        </ng-container>

        <!-- blockTotalQuantity -->
        <ng-container matColumnDef="blockTotalQuantity">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td [ngClass]="'text-white text-right ar-planning-schedule-w-auto'" class="br-1 bb-1"
            style="background-color: #7e8591!important;" mat-cell *matCellDef="let element">
            <span *ngIf="element.orderDetails.estimatedTime" title="{{element.orderDetails['totalQuantity'] || ''}}"
              class="ar-total-quantity text-right">
              {{element.orderDetails['totalQuantity'] | sum: [element.orderDetails.products.get('Euro4-97').value, element.orderDetails.products.get('Premium-95').value, element.orderDetails.products.get('B10-Diesel').value, element.orderDetails.products.get('Euro5-B7').value]}}</span>
          </td>
        </ng-container>

        <!-- blockETA -->
        <ng-container matColumnDef="blockETA">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'text-right'" class="br-1 bb-1">
            <span *ngIf="selectedDate < today || element.orderDetails.orderId">
              {{element.orderDetails.estimatedTime | date:'yyyy-MM-dd (HH:mm)'}}
            </span>
            <div
              *ngIf="selectedDate >= today && !element.orderDetails.orderId && (element.orderDetails['ron97'] || element.orderDetails['ron95'] || element.orderDetails['ron10'] || element.orderDetails['ronB7'])"
              [ngClass]="{'editable': selectedDate >= today && !element.orderDetails.orderId,'edited':  element.orderDetails.estimatedTime - element.orderDetails.fixedEstimatedTime != 0}"
              class="ar-planning-schedule-w-auto ts-time-wrapper d-flex justify-content-between align-items-baseline">
              <md2-datepicker class="time-picker-spacing" [(ngModel)]="element.orderDetails.estimatedTime"
                (ngModelChange)="updateEstimatedTime(element.index)" [format]="'y-MM-dd (HH:mm)'" [openOnFocus]="true"
                [type]="'datetime'" [min]="today" [ngModelOptions]=" {standalone: true}"></md2-datepicker>
              <i class="far fa-calendar-alt ts-calendar-icon text-white"></i>
            </div>
        </ng-container>

        <!-- blockDSPRemarks -->
        <ng-container matColumnDef="blockDSPRemarks">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center bb-1'" mat-header-cell
            *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'text-left'" class="bb-1">
            <span class="remark-box" *ngIf="selectedDate < today || element.orderDetails.orderId">
              {{element.orderDetails.remark}}
            </span>
            <div *ngIf="selectedDate >= today && !element.orderDetails.orderId && element.orderDetails.estimatedTime"
              class="w-100 h-100 d-flex justify-content-center align-element.orderDetailss-center "
              (focusin)="hasSwitched = true; dayStockLast=''">
              <input type="text" title="{{element.orderDetails.remark}}" [(ngModel)]="element.orderDetails.remark"
                [ngClass]="{'edited': element.orderDetails.remark != element.orderDetails.fixedRemark}"
                class="text-field size-14 ar-planning ar-planning-schedule-w-auto editable remark-box">
            </div>
        </ng-container>

        <ng-container matColumnDef="deliverySchedulePlanningSubEmpty">
          <th mat-header-cell *matHeaderCellDef class="empty-cell br-15"></th>
          <td mat-header-cell *matCellDef="let element" class="empty-cell br-15"></td>
        </ng-container>

        <!-- Balance -->
        <ng-container matColumnDef="Balance">
          <th style="background-color: #86cf52 !important;"
            [ngClass]="'text-center product-code-title balance product-code-background br-1 bb-1'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="Balance"></ng-container>
            <ng-template #Balance>
              <span>Balance</span>
            </ng-template>
          </th>
          <td style="background-color: #dcffc4 !important;" mat-cell *matCellDef="let element"
            [ngClass]="'text-right balance br-1 bb-1'">
            <span>{{element.remainingQuota}}</span>
          </td>
        </ng-container>

        <!-- Approve -->
        <ng-container matColumnDef="Approve">
          <th style="background-color: #263653 !important;" [ngClass]="'text-center text-white'" mat-header-cell
            *matHeaderCellDef>
            <ng-container *ngTemplateOutlet="Approve"></ng-container>
            <ng-template #Approve>
              <span>Approve</span>
            </ng-template>
          </th>
          <td mat-cell *matCellDef="let element" [ngClass]="'text-right bb-1'">
            <span>{{element.monthlyQuota}}</span>
          </td>
        </ng-container>


        <!-- Forth Layer -->


        <tr mat-header-row
          *matHeaderRowDef="!tableGroupCol || !b10Diesel ? tableHeadGroupF : tableHeadGroup; sticky: true">
        </tr>
        <tr mat-header-row *matHeaderRowDef="displayIHeadGroup; sticky: true"></tr>
        <tr mat-header-row *matHeaderRowDef="displaySubHeadGroup; sticky: true"></tr>
        <tr mat-row [ngClass]="{'highlight': selectedRow == row.index}" class={{row.rowClasses}}
          (click)="selectRow(row)" *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>
  </perfect-scrollbar>

</div>


<mat-autocomplete #auto="matAutocomplete" [panelWidth]="auto">
  <mat-option *ngIf="isLoading" class="is-loading text-center">
    <mat-spinner style="margin: auto" [diameter]="20"></mat-spinner>
  </mat-option>
  <ng-container *ngIf="!isLoading && dayStockLast != ''">
    <mat-option>
      <span><strong>{{dayStockLast}}</strong></span>
    </mat-option>
  </ng-container>
</mat-autocomplete>